<!doctype html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<title>Project Euler Problem 14 Solution - Zach Denton</title>
		<meta name="description" content="This page presents solutions to Project Euler Problem 14 in Python and Ruby.">
		<meta name="author" content="Zach Denton">
		<link rel="alternate" type="application/+xml" title="Zach Denton" href="/atom.xml">
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.1.1/css/bootstrap.no-icons.min.css" rel="stylesheet">
		<link href="//netdna.bootstrapcdn.com/font-awesome/2.0/css/font-awesome.css" rel="stylesheet">
		<link href="/css/screen.css" rel="stylesheet" type="text/css">
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
		<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		<script src="/js/main.js"></script>
	</head>
	<body class="">
		<div id="meny">
			<h1><a href="/">Zach Denton</a></h1>
			<nav>
			<ul>
				<li><a href="/about/">About</a></li>
				<li><a href="/archives/">Archives</a></li>
				<li><a href="http://labs.zacharydenton.com/">Experiments</a></li>
				<li><a href="/project-euler-solutions/">Project Euler</a></li>
				<li><a href="/resume.pdf">Resume</a></li>
				<li><a href="http://feeds.feedburner.com/zacharydenton">RSS</a></li>
			</ul>
			</nav>
			<a id="email" href="mailto: z@chdenton.com"><i class="icon-envelope-alt"></i> z@chdenton.com</a>
		</div>
		<div id="content">
			<div class="column column-large">
    <div class="column-padding">
        <h1>Project Euler Problem 14 Solution</h1>
        <h2 id="overview">Overview</h2>
<h3 id="question">Question</h3>
<p>The following iterative sequence is defined for the set of positive integers:</p>
<p>\(n \rightarrow \begin{cases} \tfrac{n}{2} &amp; \text{if } n \text{ is even} \\\\ 3n+1 &amp; \text{if } n \text{ is odd} \\\\ \end{cases}\)</p>
<p>Using the rule above and starting with 13, we generate the following sequence:</p>
<p>\(13, 40, 20, 10, 5, 16, 8, 4, 2, 1\)</p>
<p>It can be seen that this sequence (starting at 13 and finishing at 1) contains 10 terms. Although it has not been proved yet (Collatz Problem), it is thought that all starting numbers finish at 1.</p>
<p>Which starting number, under one million, produces the longest chain?</p>
<p>NOTE: Once the chain starts the terms are allowed to go above one million.</p>
<h2 id="solutions">Solutions</h2>
<h3 id="python">Python</h3>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python</span>
<span class="kw">def</span> next_collatz(n):
    <span class="kw">if</span> n % <span class="dv">2</span> == <span class="dv">0</span>:
        <span class="kw">return</span> n / <span class="dv">2</span>
    <span class="kw">else</span>:
        <span class="kw">return</span> <span class="dv">3</span>*n + <span class="dv">1</span>

<span class="kw">def</span> collatz(start):
    <span class="kw">if</span> start &lt; <span class="dv">1</span>:
        <span class="kw">raise</span> <span class="ot">ValueError</span>(<span class="st">&quot;start must be greater than or equal to 1&quot;</span>)
    <span class="kw">elif</span> start == <span class="dv">1</span>:
        <span class="kw">return</span> [<span class="dv">1</span>]

    res = [start]
    done = <span class="ot">False</span>
    <span class="kw">while</span> not done:
        res += [next_collatz(res[-<span class="dv">1</span>])]
        <span class="kw">if</span> res[-<span class="dv">1</span>] == <span class="dv">1</span>: done = <span class="ot">True</span>
    <span class="kw">return</span> res

_collatz_cache = {}
<span class="kw">def</span> lencollatz(start):
    <span class="kw">if</span> start &lt; <span class="dv">1</span>:
        <span class="kw">raise</span> <span class="ot">ValueError</span>(<span class="st">&quot;start must be greater than or equal to 1&quot;</span>)
    <span class="kw">elif</span> start == <span class="dv">1</span>:
        <span class="kw">return</span> <span class="dv">1</span>

    n = start
    length = <span class="dv">1</span>
    done = <span class="ot">False</span>
    <span class="kw">while</span> not done:
        n = next_collatz(n)
        <span class="kw">try</span>:
            length += _collatz_cache[n]
            done = <span class="ot">True</span>
        <span class="kw">except</span>:
            length += <span class="dv">1</span>
            <span class="kw">if</span> n == <span class="dv">1</span>: done = <span class="ot">True</span>
    _collatz_cache[start] = length
    <span class="kw">return</span> length

max_len = <span class="dv">0</span>
max_i = <span class="ot">None</span>
<span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">1</span>, <span class="dv">1000000</span>):
    l = lencollatz(i)
    <span class="kw">if</span> l &gt; max_len:
        max_len = l
        max_i = i
<span class="kw">print</span> max_i</code></pre>
<pre><code>$ time pypy longest-chain.py
real	0m1.278s
user	0m1.175s
sys	0m0.099s</code></pre>
<h3 id="ruby">Ruby</h3>
<pre class="sourceCode ruby"><code class="sourceCode ruby"><span class="kw">#!/usr/bin/env ruby</span>

max_l = <span class="dv">0</span>
max_i = <span class="dv">0</span>
<span class="dv">500001</span>.step(<span class="dv">1000000</span>, <span class="dv">2</span>).each <span class="kw">do</span> |i|
	l = <span class="dv">0</span>
	j = i
	while j != <span class="dv">1</span> <span class="kw">do</span>
		<span class="kw">if</span> j.even?
			j /= <span class="dv">2</span>
		<span class="kw">else</span>
			j = <span class="dv">3</span> * j + <span class="dv">1</span>
		<span class="kw">end</span>
		l += <span class="dv">1</span>
	<span class="kw">end</span>
	<span class="kw">if</span> l &gt; max_l
		max_l = l
		max_i = i
	<span class="kw">end</span>
<span class="kw">end</span>

puts max_i</code></pre>
<pre><code>$ time ruby longest-chain.rb
real	0m4.627s
user	0m4.593s
sys	0m0.021s</code></pre>
    </div>
</div>

			<div class="column column-small archives" id="recentposts">
				<div class="column-padding">
					<h1>Blog</h1>
					<article>
<time datetime="2012-12-28"><span class="line-left"></span>Dec 28 2012<span class="line-right"></span></time>
<h2><a class="title" href="/best-of-2012/">Best of 2012</a></h2>
<p>
Wherein I list the best books, movies, music, and websites of 2012.
</p>
</article>
<article>
<time datetime="2012-05-14"><span class="line-left"></span>May 14 2012<span class="line-right"></span></time>
<h2><a class="title" href="/export-facebook-contacts-with-android/">Export Facebook Contacts with Android</a></h2>
<p>
How to use a rooted Android phone to export your Facebook address book.
</p>
</article>
<article>
<time datetime="2011-12-29"><span class="line-left"></span>Dec 29 2011<span class="line-right"></span></time>
<h2><a class="title" href="/music-server-revisited-streaming-with-sshfs-and-mp3fs/">Music Server Revisited: Streaming with sshfs and mp3fs</a></h2>
<p>
Access a remote music collection seamlessly with user-space filesystems.
</p>
</article>
<article>
<time datetime="2011-12-29"><span class="line-left"></span>Dec 29 2011<span class="line-right"></span></time>
<h2><a class="title" href="/a-star-search-with-multiple-targets-and-sources/">A* Search with Multiple Targets and Sources</a></h2>
<p>
An extension of the A* algorithm to support pathfinding from many starting points to many goal points in a single pass.
</p>
</article>
<article>
<time datetime="2011-10-05"><span class="line-left"></span>Oct  5 2011<span class="line-right"></span></time>
<h2><a class="title" href="/iceland/">Iceland</a></h2>
<p>
I spent the final week of my trip exploring Iceland.
</p>
</article>
<article>
<time datetime="2011-10-04"><span class="line-left"></span>Oct  4 2011<span class="line-right"></span></time>
<h2><a class="title" href="/copenhagen/">Copenhagen</a></h2>
<p>
A brief visit to Copenhagen.
</p>
</article>
<article>
<time datetime="2011-10-04"><span class="line-left"></span>Oct  4 2011<span class="line-right"></span></time>
<h2><a class="title" href="/berlin/">Berlin</a></h2>
<p>
A great time in Berlin, especially in Kreuzberg.
</p>
</article>
<article>
<time datetime="2011-10-01"><span class="line-left"></span>Oct  1 2011<span class="line-right"></span></time>
<h2><a class="title" href="/vienna/">Vienna</a></h2>
<p>
Vienna is now among my favorite European cities.
</p>
</article>

					<hr class="short">
					<p class="centered"><strong><a href="/archives/">View All Posts</a></strong></p>
				</div>
			</div>
			<div class="column column-small">
				<div class="column-padding">
					<h1>Twitter</h1>
					<div id="tweets"></div>
					<p class="centered"><strong><a href="//twitter.com/zacharydenton">Twitter Stream</a></strong></p>
				</div>
			</div>
			<div class="column column-medium">
				<div class="column-padding">
					<div id="googleplus"></div>
					<p class="centered"><strong><a href="https://plus.google.com/103362376417669694940?rel=author">Google+ Profile</a></strong></p>
				</div>
			</div>
			<div class="column column-small">
				<div class="column-padding">
					<h1>GitHub</h1>
					<div id="github-feed"></div>
					<p class="centered"><strong><a href="//github.com/zacharydenton">GitHub Profile</a></strong></p>
				</div>
			</div>
			<div class="column column-small">
				<div class="column-padding">
					<h1>Music</h1>
					<div id="lastfm"></div>
					<p class="centered"><strong><a href="//last.fm/user/zacharydenton">Last.fm Stream</a></strong></p>
				</div>
			</div>
		</div>
	</body>
</html>
