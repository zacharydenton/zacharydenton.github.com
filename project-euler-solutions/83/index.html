<!doctype html>

<html lang="en-us">

	<head>
		<meta charset="utf-8">
		<title>Project Euler Problem 83 Solution - Zach Denton</title>
		<meta name="author" content="Zach Denton">
		<meta name="description" content="This page presents a Python solution to Project Euler Problem 83.">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Share+Tech:400">
		<link rel="stylesheet" href="../../css/main.css">
		
		<script type="text/x-mathjax-config">
			MathJax.Hub.Config({
  			tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  		});
		</script>
		<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		
	</head>
	
	<body>
	
		<div id="banner"></div>
		<header role="banner">
			<h1><a href="../../">Zach Denton</a></h1>
			<nav>
			<ul>
				<li><a href="../../about/">About</a></li>
				<li><a href="../../archives/">Blog</a></li>
				<li><a href="../../project-euler-solutions/">Euler</a></li>
				<li><a href="https://github.com/zacharydenton">GitHub</a></li>
				<li><a href="../../resume.pdf">Resume</a></li>
			</ul>
			</nav>
		</header>

		<article>
  <h1>Project Euler Problem 83 Solution</h1>

  <h2 id="question">Question</h2>
<p class="info">
NOTE: This problem is a significantly more challenging version of <a href="http://projecteuler.net/index.php?section=problems&amp;id=81">Problem 81</a>.
</p>
<p>
In the 5 by 5 matrix below, the minimal path sum from the top left to the bottom right, by moving left, right, up, and down, is indicated in bold red and is equal to 2297.
</p>
<table cellpadding="0" cellspacing="0" border="0" align="center">
	<tbody><tr>
		<td>
			<table cellpadding="3" cellspacing="0" border="0">
				<tbody><tr>
					<td>
<span style="color:#dd0000;"><b>131</b></span>
</td><td>
673
</td><td>
<span style="color:#dd0000;"><b>234</b></span>
</td><td>
<span style="color:#dd0000;"><b>103</b></span>
</td><td>
<span style="color:#dd0000;"><b>18</b></span>
</td>
				</tr>
				<tr>
					<td>
<span style="color:#dd0000;"><b>201</b></span>
</td><td>
<span style="color:#dd0000;"><b>96</b></span>
</td><td>
<span style="color:#dd0000;"><b>342</b></span>
</td><td>
965
</td><td>
<span style="color:#dd0000;"><b>150</b></span>
</td>
				</tr>
				<tr>
					<td>
630
</td><td>
803
</td><td>
746
</td><td>
<span style="color:#dd0000;"><b>422</b></span>
</td><td>
<span style="color:#dd0000;"><b>111</b></span>
</td>
				</tr>
				<tr>
					<td>
537
</td><td>
699
</td><td>
497
</td><td>
<span style="color:#dd0000;"><b>121</b></span>
</td><td>
956
</td>
				</tr>
				<tr>
					<td>
805
</td><td>
732
</td><td>
524
</td><td>
<span style="color:#dd0000;"><b>37</b></span>
</td><td>
<span style="color:#dd0000;"><b>331</b></span>
</td>
				</tr>
			</tbody></table>
		</td>
	</tr>
</tbody></table>
<p>
Find the minimal path sum, in <a href="http://projecteuler.net/project/matrix.txt">matrix.txt</a> (right click and ‘Save Link/Target As…’), a 31K text file containing a 80 by 80 matrix, from the top left to the bottom right by moving left, right, up, and down.
</p>

</div>







<h2 id="python">Python</h2>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python2</span>
<span class="ch">import</span> os
<span class="ch">import</span> heapq

<span class="kw">def</span> parse(matfile):
    <span class="kw">return</span> [[<span class="dt">int</span>(n) <span class="kw">for</span> n in row.split(<span class="st">','</span>)] <span class="kw">for</span> row in matfile]

<span class="kw">def</span> distance(a, b):
    <span class="kw">return</span> <span class="dt">sum</span>(<span class="dt">abs</span>(a[i] - b[i]) <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dt">len</span>(a)))

<span class="kw">def</span> astar(matrix, targets, sources):
    <span class="kw">def</span> neighbors(position):
        (x, y) = position
        candidates = [(x - <span class="dv">1</span>, y), (x + <span class="dv">1</span>, y), (x, y - <span class="dv">1</span>), (x, y + <span class="dv">1</span>)]
        <span class="kw">return</span> [(x, y) <span class="kw">for</span> (x, y) in candidates <span class="kw">if</span> x &gt;= <span class="dv">0</span> and x &lt; <span class="dt">len</span>(matrix)
                                               and y &gt;= <span class="dv">0</span> and y &lt; <span class="dt">len</span>(matrix[<span class="dv">0</span>])]

    <span class="kw">def</span> evaluate(path):
        f = <span class="dt">sum</span>(matrix[y][x] <span class="kw">for</span> (x, y) in path)
        h = <span class="dt">min</span>(distance(path[-<span class="dv">1</span>], target) <span class="kw">for</span> target in targets)
        <span class="kw">return</span> f + h

    targets = <span class="dt">set</span>(targets)
    frontier = <span class="dt">set</span>(sources)
    explored = <span class="dt">set</span>()
    frontier_queue = []
    <span class="kw">for</span> source in sources:
        path = [source]
        heapq.heappush(frontier_queue, (evaluate(path), path))

    <span class="kw">while</span> frontier:
        (_, path) = heapq.heappop(frontier_queue)
        frontier.remove(path[-<span class="dv">1</span>])
        explored.add(path[-<span class="dv">1</span>])
        <span class="kw">if</span> path[-<span class="dv">1</span>] in targets:
            <span class="kw">return</span> path
        <span class="kw">for</span> neighbor in neighbors(path[-<span class="dv">1</span>]):
            <span class="kw">if</span> neighbor not in frontier | explored:
                frontier.add(neighbor)
                new_path = path + [neighbor]
                heapq.heappush(frontier_queue, (evaluate(new_path), new_path))

<span class="kw">def</span> main():
    <span class="kw">with</span> <span class="dt">open</span>(os.path.join(os.path.dirname(<span class="ot">__file__</span>), <span class="st">&quot;matrix.txt&quot;</span>)) <span class="ch">as</span> matfile:
        matrix = parse(matfile)
    targets = [(<span class="dt">len</span>(matrix) - <span class="dv">1</span>, <span class="dt">len</span>(matrix[<span class="dv">0</span>]) - <span class="dv">1</span>)]
    sources = [(<span class="dv">0</span>, <span class="dv">0</span>)]
    <span class="dt">print</span> <span class="dt">sum</span>(matrix[y][x] <span class="kw">for</span> (x, y) in astar(matrix, targets, sources))

<span class="kw">if</span> <span class="ot">__name__</span> == <span class="st">&quot;__main__&quot;</span>: main()</code></pre>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">time</span> python2 path-sum.py
<span class="kw">real</span>   0m2.447s
<span class="kw">user</span>   0m2.443s
<span class="kw">sys</span>    0m0.003s</code></pre>
</article>


		<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/three.js/r67/three.min.js"></script>
		<script src="../../js/main.js"></script>
	</body>
</html>
