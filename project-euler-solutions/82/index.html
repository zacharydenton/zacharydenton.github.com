<!doctype html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<title>Project Euler Problem 82 Solution - Zach Denton</title>
		<meta name="author" content="Zach Denton">
		<meta name="description" content="This page presents a Python solution to Project Euler Problem 82.">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Cabin:400,600">
		<link rel="stylesheet" href="../../ssp/source-serif-pro.css">
		<link rel="stylesheet" href="../../css/main.css">
		
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
  			tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  		});
		</script>
		<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		
	</head>
	<body>
		<header role="banner">
			<h1><a href="../../">Zach Denton</a></h1>
			<nav>
			<ul>
				<li><a href="../../about/">About</a></li>
				<li><a href="../../archives/">Blog</a></li>
				<li><a href="../../project-euler-solutions/">Euler</a></li>
				<li><a href="https://github.com/zacharydenton">GitHub</a></li>
				<li><a href="../../resume.pdf">Resume</a></li>
			</ul>
			</nav>
			<a href="mailto:z@chdenton.com"><canvas></canvas></a>
		</header>

		<article>
  <h1>Project Euler Problem 82 Solution</h1>

  <h2 id="overview">Overview</h2>
<h3 id="question">Question</h3>
<p class="info">
NOTE: This problem is a more challenging version of <a href="http://projecteuler.net/index.php?section=problems&amp;id=81">Problem 81</a>.
</p>
<p>
The minimal path sum in the 5 by 5 matrix below, by starting in any cell in the left column and finishing in any cell in the right column, and only moving up, down, and right, is indicated in red and bold; the sum is equal to 994.
</p>
<table cellpadding="0" cellspacing="0" border="0" align="center">
	<tbody><tr>
		<td>
			<table cellpadding="3" cellspacing="0" border="0">
				<tbody><tr>
					<td>
131
</td><td>
673
</td><td>
<span style="color:#dd0000;"><b>234</b></span>
</td><td>
<span style="color:#dd0000;"><b>103</b></span>
</td><td>
<span style="color:#dd0000;"><b>18</b></span>
</td>
				</tr>
				<tr>
					<td>
<span style="color:#dd0000;"><b>201</b></span>
</td><td>
<span style="color:#dd0000;"><b>96</b></span>
</td><td>
<span style="color:#dd0000;"><b>342</b></span>
</td><td>
965
</td><td>
150
</td>
				</tr>
				<tr>
					<td>
630
</td><td>
803
</td><td>
746
</td><td>
422
</td><td>
111
</td>
				</tr>
				<tr>
					<td>
537
</td><td>
699
</td><td>
497
</td><td>
121
</td><td>
956
</td>
				</tr>
				<tr>
					<td>
805
</td><td>
732
</td><td>
524
</td><td>
37
</td><td>
331
</td>
				</tr>
			</tbody></table>
		</td>
	</tr>
</tbody></table>
<p>
Find the minimal path sum, in <a href="http://projecteuler.net/project/matrix.txt">matrix.txt</a> (right click and ‘Save Link/Target As…’), a 31K text file containing a 80 by 80 matrix, from the left column to the right column.
</p>






<h2 id="solutions">Solutions</h2>
<h3 id="python">Python</h3>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/env python2</span>
<span class="ch">import</span> os
<span class="ch">import</span> heapq

<span class="kw">def</span> parse(matfile):
    <span class="kw">return</span> [[<span class="dt">int</span>(n) <span class="kw">for</span> n in row.split(<span class="st">','</span>)] <span class="kw">for</span> row in matfile]

<span class="kw">def</span> distance(a, b):
    <span class="kw">return</span> <span class="dt">sum</span>(<span class="dt">abs</span>(a[i] - b[i]) <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dt">len</span>(a)))

<span class="kw">def</span> astar(matrix, targets, sources):
    <span class="kw">def</span> neighbors(position):
        (x, y) = position
        candidates = [(x, y - <span class="dv">1</span>), (x, y + <span class="dv">1</span>), (x + <span class="dv">1</span>, y)]
        <span class="kw">return</span> [(x, y) <span class="kw">for</span> (x, y) in candidates <span class="kw">if</span> x &gt;= <span class="dv">0</span> and x &lt; <span class="dt">len</span>(matrix)
                                               and y &gt;= <span class="dv">0</span> and y &lt; <span class="dt">len</span>(matrix[<span class="dv">0</span>])]

    <span class="kw">def</span> evaluate(path):
        f = <span class="dt">sum</span>(matrix[y][x] <span class="kw">for</span> (x, y) in path)
        h = <span class="dt">min</span>(distance(path[-<span class="dv">1</span>], target) <span class="kw">for</span> target in targets)
        <span class="kw">return</span> f + h

    targets = <span class="dt">set</span>(targets)
    frontier = <span class="dt">set</span>(sources)
    explored = <span class="dt">set</span>()
    frontier_queue = []
    <span class="kw">for</span> source in sources:
        path = [source]
        heapq.heappush(frontier_queue, (evaluate(path), path))

    <span class="kw">while</span> frontier:
        (_, path) = heapq.heappop(frontier_queue)
        frontier.remove(path[-<span class="dv">1</span>])
        explored.add(path[-<span class="dv">1</span>])
        <span class="kw">if</span> path[-<span class="dv">1</span>] in targets:
            <span class="kw">return</span> path
        <span class="kw">for</span> neighbor in neighbors(path[-<span class="dv">1</span>]):
            <span class="kw">if</span> neighbor not in frontier | explored:
                frontier.add(neighbor)
                new_path = path + [neighbor]
                heapq.heappush(frontier_queue, (evaluate(new_path), new_path))

<span class="kw">def</span> main():
    <span class="kw">with</span> <span class="dt">open</span>(os.path.join(os.path.dirname(<span class="ot">__file__</span>), <span class="st">&quot;matrix.txt&quot;</span>)) <span class="ch">as</span> matfile:
        matrix = parse(matfile)
    targets = [(<span class="dt">len</span>(row) - <span class="dv">1</span>, y) <span class="kw">for</span> y, row in <span class="dt">enumerate</span>(matrix)]
    sources = [(<span class="dv">0</span>, y) <span class="kw">for</span> y, row in <span class="dt">enumerate</span>(matrix)]
    <span class="dt">print</span> <span class="dt">sum</span>(matrix[y][x] <span class="kw">for</span> (x, y) in astar(matrix, targets, sources))

<span class="kw">if</span> <span class="ot">__name__</span> == <span class="st">&quot;__main__&quot;</span>: main()</code></pre>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">time</span> python2 path-sum.py
<span class="kw">real</span>   0m2.261s
<span class="kw">user</span>   0m2.260s
<span class="kw">sys</span>    0m0.000s</code></pre>
</article>


		<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="../../js/main.js"></script>
	</body>
</html>
